"use strict";app.run(["$rootScope","MotifsService",function(n,t){n.pages={index:{name:"Accueil",searcher:!1},users:{name:"Gestion des utilisateurs",searcher:"users"},conges:{name:"Mes demandes de congés",searcher:!1},"admin-conges":{name:"Validation des congés",searcher:"admin-conges"},activite:{name:"Déclarer mon activité",searcher:!1},"admin-activite":{name:"Rapports d'activité",searcher:"admin-activite"}};n.roles=[{id:1,libelle:"Consultant"},{id:2,libelle:"Structure"},{id:3,libelle:"Admin"},{id:4,libelle:"Super Admin"}];n.etatsConges=[{id:"1",libelle:"En attente de validation",cssClass:"val"},{id:"2",libelle:"Validé",cssClass:"val"},{id:"3",libelle:"Refusé",cssClass:"val"}];n.cssConges={1:"valConges",2:"accConges",3:"refConges"};n.initConnected=function(i){n.connected=!0;i&&(n.currentUser=i,n.username=i.prenom,n.role=i.role,n.infos=i.infos);t.list().then(function(t){n.motifsConges=t;n.typeActiviteTravaille=[{id:"JT1",libelle:"En mission 1",ordre:0},{id:"JT2",libelle:"En mission 2",ordre:1},{id:"JT3",libelle:"En mission 3",ordre:2},{id:"FOR",libelle:"Formation",ordre:3},{id:"INT",libelle:"Intercontrat",ordre:4}];n.typeActiviteWeekend=[{id:"WK",libelle:"Weekend",ordre:0},{id:"JT1",libelle:"En mission 1",ordre:1},{id:"JT2",libelle:"En mission 2",ordre:2},{id:"JT3",libelle:"En mission 3",ordre:3}];n.typeActiviteAstreinte=[{id:"JF",libelle:"Journée fériée",ordre:0},{id:"JT1",libelle:"En mission 1",ordre:1},{id:"JT2",libelle:"En mission 2",ordre:2},{id:"JT3",libelle:"En mission 3",ordre:3}];n.typeActivite=angular.copy(n.typeActiviteTravaille);n.typeActivite.push.apply(n.typeActivite,n.motifsConges);n.typeActivite.push.apply(n.typeActivite,n.typeActiviteWeekend);n.typeActivite.pop();n.typeActivite.pop();n.typeActivite.pop();n.typeActivite.push.apply(n.typeActivite,n.typeActiviteAstreinte);n.typeActivite.pop();n.typeActivite.pop();n.typeActivite.pop()})};n.searcher=!1;(window.config.connected?!0:!1)&&n.initConnected(window.config)}]);app.controller("appController",["$scope","$routeParams","$rootScope",function(n,t,i){var r=location.pathname;i.pages[r.substring(1)]&&(i.idpage=r.substring(1),i.page=i.pages[r.substring(1)].name,i.searcher=i.pages[r.substring(1)].searcher)}]).controller("NavBar",["$scope","$rootScope","LoginService","$dialog",function(n,t,i,r){n.logout=function(){i.logout(function(){t.connected=!1})};n.search=function(){t.$broadcast("search",{searcher:t.searcher,search:search.value})};n.opts={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"/templates/password.html",controller:"DialogPassword"};n.changePassword=function(){t.error="";var i=r.dialog(n.opts);i.open().then(function(n){n})};n.optsContact={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"/templates/contact.html",controller:"DialogContact"};n.contact=function(){t.error="";var i=r.dialog(n.optsContact);i.open().then(function(n){n})}}]).controller("DialogPassword",["$scope","$rootScope","dialog","UsersService",function(n,t,i,r){t.error="";n.enable=!0;n.close=function(){t.error="";i.close()};n.save=function(u){n.pwdUser.$invalid||(t.error="",n.enable=!1,r.password(u).then(function(t){n.enable=!0;t&&i.close()},function(){n.enable=!0}))}}]).controller("DialogContact",["$scope","$rootScope","dialog","ContactService",function(n,t,i,r){t.error="";n.enable=!0;n.sujets=[{libelle:"Congés"},{libelle:"Compte-rendu d'activité"},{libelle:"Mon compte"},{libelle:"Poser une question..."}];n.close=function(){t.error="";i.close()};n.send=function(t){n.enable=!1;r.send(t).then(function(t){n.enable=!0;t},function(){n.enable=!0});i.close()}}]);