<div class="background light"></div>
<div class="container-fluid" id="mainConges" ng-controller="CongesMain">
  <div class="row-fluid">
    <div class="span2" ng-controller="CongesGauges">
        <!--Sidebar content-->
        <div class="row-fluid">
            <div class="span12 well gaugesWidget">
                <!--Sidebar content-->
                <gauge id="gCP" title="CP restants" label="jours" max="25" ng-model="cp"></gauge>
                <!--Sidebar content-->
                <gauge id="gCPAcc" title="CP acquis" label="jours" max="25" ng-model="cp_ant"></gauge>
            </div>
            </div> <!--<div class="row-fluid">-->
            <div class="row-fluid">
            <div class="span12 well gaugesWidget">
                <!--Sidebar content-->
                <gauge id="gRTT" title="RTT restants" label="jours" max="20" ng-model="rtt"></gauge>
            </div>
         </div><!--<div class="row-fluid">-->
    </div><!--<div class="span6">-->
      <div class="span10 congesSide">
      <!--Body content--> 
         <div class="row">
            <div class="span12">
                <button type="button" class="btn btn-primary" ng-class="{masquer: edition > 0}" ng-click="create();"><i class="icon-plus icon-white"></i> Faire une demande de congés</button>
                <div class="alert alert-block alert-info" ng-class="{masquer: edition != 1}"><h4>{{lblMode}}</h4></div>
                <div class="alert alert-block alert-warning" ng-class="{masquer: edition != 2}"><h4>{{lblMode}}</h4></div>
         </div><!-- <div class="span12">-->
        </div><!-- <div class="row">-->
        <!--Row edit--> 
        <div class="row">
            <div class="span12">
            <!--Formulaire modification utilisateurs--> 
        <form id="editConges" name="editConges" class="form-horizontal" novalidate ng-class="{masquer: edition == 0}">
            <!--Saisie motif-->
            <div class="control-group" ng-class="{error: editConges.inputMotif.$dirty && editConges.inputMotif.$invalid, success:editConges.inputMotif.$dirty && !editConges.inputMotif.$invalid}">
                <label class="control-label" for="inputRole">Motif</label>
                <div class="controls inline">
                      <select id="inputMotif" name="inputMotif" required ng-model="currentConges.motif" ng-options="motif.id as motif.libelle for motif in motifsConges">
                      </select>
                      <div class="input-help">
                          <h4>Vous devez renseigner un motif de congés.</h4>
                       </div>
                       <select ng-show="currentConges.motif == 'AE'" id="inputMotifExcep" ng-required="currentConges.motif == 'AE'" name="inputMotifExcep" ng-model="currentConges.motifExcep" ng-options="motif.id as motif.libelle for motif in motifsCongesExcep">
                       <option></option>
                      </select>
                      <div class="input-help">
                          <h4>Vous devez renseigner un motif exceptionnel de congés.</h4>
                      </div>
               </div>
            </div>
          <!--Saisie date de début de congés-->
          <div class="control-group inline" ng-class="{error: editConges.inputDateDebut.$dirty && editConges.inputDateDebut.$invalid, success:editConges.inputDateDebut.$dirty && !editConges.inputDateDebut.$invalid}">
            <label class="control-label" for="inputDateDebut">Date de début</label>
            <div class="controls">
              <input type="datetime" ng-model="currentConges.debut" required id="inputDateDebut" name="inputDateDebut" ui-date="{ dateFormat: 'dd/mm/yy', changeYear: true, changeMonth: true, yearRange: '0:+1Y', minDate: '0'}" placeholder="">
              <div class="input-help">
                  <h4>Vous devez renseigner une date de début de congés.</h4>
               </div>
            </div>
            <div ng-show="!editConges.inputDateDebut.$invalid" class="typeDate">
                <label class="radio inline">
                    <input type="radio" ng-model="currentConges.debutType" checked="checked" id="inputMatinDebut" name="inputTypeDebut" value="0" />Matin
                </label>
              <label class="radio inline aprem">
                <input type="radio" ng-model="currentConges.debutType" required id="inputApremDebut" name="inputTypeDebut" value="1" />Après-midi
              </label>
            </div>
          </div>
          <!--Saisie date de début de congés-->
          <div class="control-group" ng-class="{error: editConges.inputDateFin.$dirty && editConges.inputDateFin.$invalid, success:editConges.inputDateFin.$dirty && !editConges.inputDateFin.$invalid}">
            <label class="control-label" for="inputDateFin">Date de début</label>
            <div class="controls">
              <input type="datetime" ng-model="currentConges.fin" required id="inputDateFin" name="inputDateFin"  ui-validate="{test:'$value >= currentConges.debut'}" ui-validate-watch=" 'currentConges.debut' " ui-date="{ dateFormat: 'dd/mm/yy', changeYear: true, changeMonth: true, yearRange: '0:+1Y', minDate: '0'}" placeholder="">
              <div class="input-help">
                  <h4>Vous devez renseigner une date de fin de congés supérieure ou égale à la date de début.</h4>
               </div>
            </div>
            <div ng-show="!editConges.inputDateFin.$invalid" class="typeDate">
                <label class="radio inline">
                    <input type="radio" ng-model="currentConges.finType" required id="inputMidiFin" name="inputTypeFin" value="0" />Midi
                </label>
              <label class="radio inline aprem">
                <input type="radio" ng-model="currentConges.finType" checked="checked" required id="inputSoirFin" name="inputTypeFin" value="1" />Soir
              </label>
            </div>
          </div>
            <!--Saisie justification-->
          <div class="control-group" ng-class="{error: editConges.inputJustificatif.$dirty && editConges.inputJustificatif.$invalid, success:editConges.inputJustificatif.$dirty && !editConges.inputJustificatif.$invalid}">
            <label class="control-label" for="inputJustificatif">Justification (optionnel)</label>
            <div class="controls">
              <textarea type="text" id="Text1" name="inputJustification" rows="3" class="input-xxlarge" ng-model="currentConges.justification" placeholder="Justification"></textarea>
            </div>
          </div>
          <div class="control-group">
            <div class="controls">
            </div>
          </div>
            <div class="control-group">
            <div class="controls">
            </div>
          </div>
          <!--Zone d'action du formulaire-->
            <div class="form-actions">
              <div class="control-group">
                <span ng-class="{masquer: editConges.$valid}" class="label label-important">Tous les champs doivent être valides pour enregistrer.</span>
              </div>
              <div class="control-group" ng-class="{masquer: !error}">
                <span class="label label-important">{{error}}</span>
              </div>
              <button type="button" ng-disabled="editConges.$invalid  || isUnchanged(currentConges)" ng-click="save(currentConges);" class="btn btn-primary">Envoyer</button>
              <button type="button" class="btn" ng-click="cancel();" >Annuler</button>
            </div>
        </form>
        <!--Fin Formulaire modification utilisateurs-->
         </div><!--<div class="span12">-->
        </div><!--<div class="row">-->

          <div class="row">
            <div class="span12" ng-controller="CongesGrid">
                <!--Grilles des congés--> 
                <div id="congesGrid" class="gridStyle" ng-grid="gridOptionsConges"></div>
            </div><!-- <div class="span12">-->
        </div><!-- <div class="row">-->
    </div><!--<div class="span9">-->
  </div><!--<div class="row-fluid">-->
</div><!--<div class="container-fluid">-->

<!--Template de la colonne d'action de la grille-->
<script type="text/x-handlebars-template" id="headerTmpl">
    <div class="ngHeaderSortColumn {{col.headerClass}}" ng-style="{cursor: col.cursor}" ng-class="{ ngSorted: !noSortVisible }">
        <div ng-click="col.sort($event)" ng-class="'colt' + col.index" class="ngHeaderText" data-toggle="tooltip" title="{{col.displayName}}">{{col.displayName}}</div>
        <div class="ngSortButtonDown" ng-show="col.showSortButtonDown()"></div>
        <div class="ngSortButtonUp" ng-show="col.showSortButtonUp()"></div>
        <div class="ngSortPriority">{{col.sortPriority}}</div>
    </div>
    <div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>
</script>
<script type="text/x-handlebars-template" id="actionRowTmpl">
    <div class="btn-group">
        <button class="btn btn-danger dropdown-toggle" data-toggle="dropdown" type="button" >
            <i class="icon icon-cog"></i> <b class="caret"> </b>
        </button>
        <ul class="actionEdit dropdown-menu">
            <li><a href="#" ng-click="edit(row)"><i class="icon-pencil"></i> Modifier</a></li>
            <li><a href="#" ng-click="delete(row)"><i class="icon-trash"></i> Supprimer</a></li>
        </ul>
     </div>
</script>
<script type="text/x-handlebars-template" id="actionRowTmplEdit">
    <a href="#" title="Modifier" ng-show="isEditable(row.entity)" ng-click="edit(row)"><i class="icon-pencil"></i></a>
</script>
<script type="text/x-handlebars-template" id="actionRowTmplDel">
    <a href="#" title="Supprimer" ng-show="isEditable(row.entity)" ng-click="delete(row)"><i class="icon-trash"></i></a>
</script>